[{"path":"https://github.mbacou.io/WADashboard/articles/01_get-started.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Get Started","text":"repository contains server client codes Water Accounting+ visualization dashboard. codes assets provided standard R package. dashboard application written R uses open-source R/Shiny framework. dashboard uses output IWMI WA+ hydrological models, main code routine documented WAPORWA (WaPOR-based Water Accounting). Two hydrological basin provided initial release, lower Niger River Mali Mara River Kenya. differences two use cases, terms data availability temporal scope (e.g. Mali subset entire WAPORWA model obtained), meaning level details available dashboard vary according river basin.","code":""},{"path":"https://github.mbacou.io/WADashboard/articles/01_get-started.html","id":"usage","dir":"Articles","previous_headings":"","what":"Usage","title":"Get Started","text":"easiest get started install package development version GitHub R console: preview dashboard browser : choose clone repo instead, application can previewed R console :","code":"if (!require(\"remotes\")) install.packages(\"remotes\") remotes::install_github(\"mbacou/WADashboard\") if (!require(\"shiny\")) install.packages(\"shiny\") shiny::shinyAppDir(system.file(\"app\", package=\"WADashboard\")) shiny::runApp()"},{"path":"https://github.mbacou.io/WADashboard/articles/01_get-started.html","id":"repository-structure","dir":"Articles","previous_headings":"","what":"Repository Structure","title":"Get Started","text":"repo structured standard R package, particular: /data-raw: configuration files /inst: client server scripts web assets Shiny application /R: custom R functions (see Reference) /docs: rendered HTML documentation (website) application can previewed browser source(\"app.R\"). Shell scripts provided automate common tasks: ./build.sh: rebuild install package ./pkgdown.sh: rebuild HTML package documentation (uses pkgdown framework) ./deploy.sh <tag>: commit tagged release Github, rebuild Docker image, deploy image AWS ECR (need AWS cli valid AWS access key deploy AWS cloud command line)","code":""},{"path":"https://github.mbacou.io/WADashboard/articles/01_get-started.html","id":"configuration","dir":"Articles","previous_headings":"","what":"Configuration","title":"Get Started","text":"WA_DATA pointing root location WA+ model output (collection CSV NetCDF files). local cloud-based storage type may implemented (incl. Amazon S3). WA_ROOT pointing Shiny server root location (default /srv/shiny-server/WADashboard might want deploy different location). WA_LIB pointing location local R library (default Linux shared library /usr/local/lib/R/site-library) List river basins Catalog contextual geospatial layers Rebuild R package reinstall executing ./build.sh. append new river basin, make sure can successfully ETL data datat_etl(\"new_basin_code\") rebuilding package.","code":""},{"path":"https://github.mbacou.io/WADashboard/articles/01_get-started.html","id":"application-deployment","dir":"Articles","previous_headings":"","what":"Application Deployment","title":"Get Started","text":"Docker image file provided deployment AWS ECS (Fargate). image includes Shiny Server Community Edition (development ) RStudio Server Preview. can build test image locally : ’ve established container runs locally, can deployed AWS ECS (see ./deploy.sh automated deployment script): dashboard application served host http://localhost/WADashboard/. RStudio IDE reachable http://localhost:8787/ (replace localhost container’s public IP domain name).","code":"# replace {pwd} with a chosen password for the default rstudio user docker build -t wadashboard . docker run --name wadashboard PASSWORD={pwd} -p 80:3838 -p 8787:8787 wadashboard # Authenticate your local Docker client aws ecr get-login-password --region {region} | docker login --username AWS --password-stdin {aws_account_id}.dkr.ecr.{region}.amazonaws.com # Tag your image with your Amazon ECR registry docker tag wadashboard {aws_account_id}.dkr.ecr.{region}.amazonaws.com/wadashboard # Push the image to your AWS ECR registry docker push {aws_account_id}.dkr.ecr.{region}.amazonaws.com/wadashboard"},{"path":"https://github.mbacou.io/WADashboard/articles/02_data-etl-csv.html","id":"file-and-variable-inventory","dir":"Articles","previous_headings":"","what":"File and Variable Inventory","title":"Data ETL (CSV Ouput Files)","text":"start inventorying basin-level variables contained modeled CSV files. 8 yearly water balances Mali (Sheet #1 variables), 15 yearly balances Kenya (across 6 sheets), well monthly seasonal breakdowns. Kenya analysis also includes yearly, seasonal, monthly time-series additional 57 variables:","code":"# List all output CSV data <- list(   ken = file.path(dir, \"./ken/hydroloop_results/csv\"),   mli = file.path(dir, \"/mli/csv_km3\") ) %>%   lapply(list.files, pattern=\"*.csv\", recursive=TRUE, full.names=TRUE) %>%   lapply(data.table) %>%   rbindlist(idcol=\"iso3\", use.names=TRUE, fill=TRUE) %>%   setnames(\"V1\", \"path\")  # Extract timestamps and sheet codes from file names data[, `:=`(   file = basename(path) )][, `:=`(   year = str_extract(file, \"_[0-9]{4}\") %>% str_sub(2,5) %>% as.integer(),   month = str_extract(file, \"[0-9]{4}_[0-9]{1,2}\") %>% str_sub(6,7) %>% as.integer(),   sheet = str_extract(tolower(file), \"sheet[0-9]{1}\")  )] %>% setorder(iso3, sheet, year, month, na.last=TRUE)  # Append flow units (typically km3 or MCM, will need to be specified manually) data[, unit := fcase(   iso3==\"mli\", \"km3\",   iso3==\"ken\", \"km3\" )] data[iso3==\"mli\", .(iso3, file, sheet, year, month)] %>%    paged_table() data[iso3==\"ken\" & !is.na(year) & is.na(month), .(iso3, file, sheet, year, month)] %>%    paged_table() data[iso3==\"ken\" & !is.na(month), .(iso3, file, sheet, year, month)] %>%    paged_table() data[iso3==\"ken\" & is.na(year) & is.na(month), .(iso3, file, sheet, year, month)] %>%    paged_table()"},{"path":"https://github.mbacou.io/WADashboard/articles/02_data-etl-csv.html","id":"variable-inspection","dir":"Articles","previous_headings":"","what":"Variable Inspection","title":"Data ETL (CSV Ouput Files)","text":"also need validate naming conventions units output variables, continue inspecting individual files starting Mali.","code":""},{"path":"https://github.mbacou.io/WADashboard/articles/02_data-etl-csv.html","id":"sheet-1","dir":"Articles","previous_headings":"Variable Inspection","what":"Sheet #1","title":"Data ETL (CSV Ouput Files)","text":"Output Sheet #1 include 34 unique variables categorized class subclass. naming consistent across years.  Similarly look Kenya’s monthly time-series. First Sheet #1 variables:","code":"f <- data[iso3==\"mli\"]  mli <- lapply(1:nrow(f), function(x) fread(f[x, path])[, `:=`(   iso3 = f[x, iso3],   sheet = f[x, sheet],   year = f[x, year] )]) %>% rbindlist()  setnames(mli, tolower(names(mli))) mli %>% paged_table(options=list(max.print=300)) mli %>%    ggplot() +   geom_line(aes(year, value, color=paste(class, subclass))) +   facet_grid(paste(class, subclass, variable)~., scales=\"free_y\") +   th() +   labs(x=NULL, y=NULL) +   ggtitle(\"WA+ Sheet 1 Variables - Mali, 2009 to 2016\") f <- data[iso3==\"ken\" & !is.na(month) & !is.na(year) & sheet==\"sheet1\"] ken_1 <- lapply(1:nrow(f), function(x) fread(f[x, path])[, `:=`(   iso3 = f[x, iso3],   sheet = f[x, sheet],   year = f[x, year],   month = f[x, month] )]) %>% rbindlist()  setnames(ken_1, tolower(names(ken_1))) ken_1 %>% paged_table(options=list(max.print=300)) ken_1 %>%    ggplot() +   geom_line(aes(as.Date(paste(year, month, 1), \"%Y %m %d\"), value, color=subclass)) +   facet_grid(paste(class, subclass, variable)~., scales=\"free_y\") +   th() +   labs(x=NULL, y=NULL) +   ggtitle(\"WA+ Sheet 1 Variables - Kenya, 2003 to 2017\")"},{"path":"https://github.mbacou.io/WADashboard/articles/02_data-etl-csv.html","id":"sheet-2","dir":"Articles","previous_headings":"Variable Inspection","what":"Sheet #2","title":"Data ETL (CSV Ouput Files)","text":"extract Sheet #2 variables (breakdown evapotranspiration land use classes): sheet uses different data structure, can normalized “long” format: plot variables first land use class illustration purposes:","code":"f <- data[iso3==\"ken\" & !is.na(month) & !is.na(year) & sheet==\"sheet2\"] ken_2 <- lapply(1:nrow(f), function(x) fread(f[x, path])[, `:=`(   iso3 = f[x, iso3],   sheet = f[x, sheet],   year = f[x, year],   month = f[x, month] )]) %>% rbindlist()  setnames(ken_2, tolower(names(ken_2))) ken_2 %>% paged_table(options=list(max.print=300)) # Normalize ken_2 <- melt(ken_2, id.vars=c(\"land_use\", \"class\", \"iso3\", \"sheet\", \"year\", \"month\"),   variable.factor=FALSE) # Standardize category names setnames(ken_2, c(\"land_use\", \"class\"), c(\"class\", \"subclass\")) setorder(ken_2, class, subclass, variable, year, month) ken_2[class %in% ken_2[, unique(class)][1]] %>%    ggplot() +   geom_line(aes(as.Date(paste(year, month, 1), \"%Y %m %d\"), value, color=subclass)) +   facet_grid(paste(class, subclass, variable)~., scales=\"free_y\") +   th() +   labs(x=NULL, y=NULL) +   ggtitle(\"WA+ Sheet 2 Variables - Kenya, 2003 to 2017\")"},{"path":"https://github.mbacou.io/WADashboard/articles/02_data-etl-csv.html","id":"sheet-3","dir":"Articles","previous_headings":"Variable Inspection","what":"Sheet #3","title":"Data ETL (CSV Ouput Files)","text":"Similarly inspect results Sheet #3 “Agriculture Services”. Kenya analysis, variables Sheet #3 Sheet #6 available yearly, seasonal, /monthly time-series (across multiple CSV files). (arbitrarily) gather seasonal time-series1 : Plotting entire series (6 variables):  Finally gather Sheet #1 Sheet #3 variables long table format (data cube). consistency’s sake, encode date_start date_end sheets (incl. yearly monthly variables): generated data cube includes following dimensions: iso3 sheet class subclass variable year month date_start date_end value","code":"f <- data[iso3==\"ken\" & sheet==\"sheet3\" &      str_detect(file, \"season\") & str_detect(file, \"54.0\")] ken_3 <- lapply(1:nrow(f), function(x) fread(f[x, path])[, `:=`(   iso3 = f[x, iso3],   sheet = f[x, sheet],   year = f[x, year],   month = f[x, month],   variable = str_replace(f[x, file], \"sheet3_54.0_\", \"\") %>% str_replace(\"_season.csv\", \"\") )]) %>% rbindlist()  ken_3[, `:=`(   # Drop counter column   V1 = NULL,   # Ensure end of season is last day of month (for consistency with other sheets)   end_dates = end_dates - 1 )][, `:=`(   # Encode year/month columns using end of season   year = year(end_dates),   month = month(end_dates) )]  setnames(ken_3,    c(\"Seasonal\", \"start_dates\", \"end_dates\"), c(\"value\", \"date_start\", \"date_end\")) setcolorder(ken_3,    c(\"iso3\", \"sheet\", \"variable\", \"date_start\", \"date_end\", \"year\", \"month\", \"value\")) setorder(ken_3, variable, year, month) ken_3 %>% paged_table(options=list(max.print=300)) ken_3 %>%    ggplot() +   geom_line(aes(as.Date(paste(year, month, 1), \"%Y %m %d\"), value, color=variable)) +   facet_grid(variable~., scales=\"free_y\") +   th() +   labs(x=NULL, y=NULL) +   ggtitle(\"WA+ Sheet 3 Variables - Kenya, 2003 to 2017 (seasonal)\") ## Warning: Removed 24 row(s) containing missing values (geom_path). cube <- rbind(mli, ken_1, ken_2, ken_3, fill=TRUE) setcolorder(cube,    c(\"iso3\", \"sheet\", \"class\", \"subclass\", \"variable\",      \"year\", \"month\", \"date_start\", \"date_end\")) cube[is.na(date_start) & is.na(month), `:=`(   # yearly series: 1/1 to 12/31   date_start = as.IDate(paste(year, 1, 1), \"%Y %m %d\"),   date_end = as.IDate(paste(year, 12, 31), \"%Y %m %d\") )][is.na(date_start) & !is.na(month), `:=`(   # monthly series: 1/1 to 1/31   date_start = as.IDate(paste(year, month, 1), \"%Y %m %d\"),   date_end = ceiling_date(as.IDate(paste(year, month, 20), \"%Y %m %d\"), \"months\") - days(1) )]  #saveRDS(cube, \"./data-raw/rds/data.rds\")"},{"path":"https://github.mbacou.io/WADashboard/articles/02_data-etl-csv.html","id":"data-dictionaries","dir":"Articles","previous_headings":"","what":"Data Dictionaries","title":"Data ETL (CSV Ouput Files)","text":"Another ETL step required map variable codes used data files visual representation WA+ Sheets (SVG designs). mapping embedded WA+ print_sheet Python module, (example Sheet 1 WAPORWA repo). Importantly many SVG elements fields calculated output variables. might need replicate logic dashboard create dynamic visuals2.","code":"knitr::include_graphics(file.path(\"./fig\", list.files(\"./vignettes/fig\")))"},{"path":"https://github.mbacou.io/WADashboard/articles/02_data-etl-csv.html","id":"sheet-1-1","dir":"Articles","previous_headings":"Data Dictionaries","what":"Sheet #1","title":"Data ETL (CSV Ouput Files)","text":"Field mappings constructed table . Formulas calculated fields replicated . proceed similarly Sheet #2 Sheet #3 mappings.","code":"s1 <- fread(system.file(\"./csv/sheet_1_schema.csv\", package=\"WADashboard\")) %>%    paged_table()"},{"path":[]},{"path":"https://github.mbacou.io/WADashboard/articles/02_data-etl-csv.html","id":"sheet-3-1","dir":"Articles","previous_headings":"Data Dictionaries","what":"Sheet #3","title":"Data ETL (CSV Ouput Files)","text":"next vignette outline approach ingest gridded NetCDF output files.","code":""},{"path":"https://github.mbacou.io/WADashboard/articles/02_data-etl.html","id":"basin-level-aggregates-csv-files","dir":"Articles","previous_headings":"","what":"Basin-level Aggregates (CSV files)","title":"Data ETL","text":"start inventorying basin-level variables contained modeled CSV files. 8 yearly water balances Mali (Sheet #1 variables), 15 yearly balances Kenya (across 6 sheets), well monthly seasonal breakdowns. Kenya analysis also includes yearly, seasonal, monthly time-series additional 57 variables:","code":"# List all output CSV data <- list(   ken = file.path(dir, \"./ken/hydroloop_results/csv\"),   mli = file.path(dir, \"/mli/csv_km3\") ) %>%   lapply(list.files, pattern=\"*.csv\", recursive=TRUE, full.names=TRUE) %>%   lapply(data.table) %>%   rbindlist(idcol=\"iso3\", use.names=TRUE, fill=TRUE) %>%   setnames(\"V1\", \"path\")  # Extract timestamps and sheet codes from file names data[, `:=`(   file = basename(path) )][, `:=`(   year = str_extract(file, \"_[0-9]{4}\") %>% str_sub(2,5) %>% as.integer(),   month = str_extract(file, \"[0-9]{4}_[0-9]{1,2}\") %>% str_sub(6,7) %>% as.integer(),   sheet = str_extract(tolower(file), \"sheet[0-9]{1}\")  )] %>% setorder(iso3, sheet, year, month, na.last=TRUE)  # Append flow units (typically km3 or MCM, will need to be specified manually) data[, unit := fcase(   iso3==\"mli\", \"km3\",   iso3==\"ken\", \"km3\" )] data[iso3==\"mli\", .(iso3, file, sheet, year, month)] %>%    paged_table() data[iso3==\"ken\" & !is.na(year) & is.na(month), .(iso3, file, sheet, year, month)] %>%    paged_table() data[iso3==\"ken\" & !is.na(month), .(iso3, file, sheet, year, month)] %>%    paged_table() data[iso3==\"ken\" & is.na(year) & is.na(month), .(iso3, file, sheet, year, month)] %>%    paged_table()"},{"path":"https://github.mbacou.io/WADashboard/articles/02_data-etl.html","id":"variable-inspection","dir":"Articles","previous_headings":"Basin-level Aggregates (CSV files)","what":"Variable Inspection","title":"Data ETL","text":"also need validate naming conventions units output variables, continue inspecting individual files starting Mali.","code":""},{"path":"https://github.mbacou.io/WADashboard/articles/02_data-etl.html","id":"sheet-1","dir":"Articles","previous_headings":"Basin-level Aggregates (CSV files) > Variable Inspection","what":"Sheet #1","title":"Data ETL","text":"Output Sheet #1 include 34 unique variables categorized class subclass. naming consistent across years.  Similarly look Kenya’s monthly time-series. First Sheet #1 variables:","code":"f <- data[iso3==\"mli\"]  mli <- lapply(1:nrow(f), function(x) fread(f[x, path])[, `:=`(   iso3 = f[x, iso3],   sheet = f[x, sheet],   year = f[x, year] )]) %>% rbindlist()  setnames(mli, tolower(names(mli))) mli %>% paged_table(options=list(max.print=300)) mli %>%    ggplot() +   geom_line(aes(year, value, color=paste(class, subclass))) +   facet_grid(paste(class, subclass, variable)~., scales=\"free_y\") +   th() +   labs(x=NULL, y=NULL) +   ggtitle(\"WA+ Sheet 1 Variables - Mali, 2009 to 2016\") f <- data[iso3==\"ken\" & !is.na(month) & !is.na(year) & sheet==\"sheet1\"] ken_1 <- lapply(1:nrow(f), function(x) fread(f[x, path])[, `:=`(   iso3 = f[x, iso3],   sheet = f[x, sheet],   year = f[x, year],   month = f[x, month] )]) %>% rbindlist()  setnames(ken_1, tolower(names(ken_1))) ken_1 %>% paged_table(options=list(max.print=300)) ken_1 %>%    ggplot() +   geom_line(aes(as.Date(paste(year, month, 1), \"%Y %m %d\"), value, color=subclass)) +   facet_grid(paste(class, subclass, variable)~., scales=\"free_y\") +   th() +   labs(x=NULL, y=NULL) +   ggtitle(\"WA+ Sheet 1 Variables - Kenya, 2003 to 2017\")"},{"path":"https://github.mbacou.io/WADashboard/articles/02_data-etl.html","id":"sheet-2","dir":"Articles","previous_headings":"Basin-level Aggregates (CSV files) > Variable Inspection","what":"Sheet #2","title":"Data ETL","text":"extract Sheet #2 variables (breakdown evapotranspiration land use classes): sheet uses different data structure, can normalized “long” format: plot variables first land use class illustration purposes:","code":"f <- data[iso3==\"ken\" & !is.na(month) & !is.na(year) & sheet==\"sheet2\"] ken_2 <- lapply(1:nrow(f), function(x) fread(f[x, path])[, `:=`(   iso3 = f[x, iso3],   sheet = f[x, sheet],   year = f[x, year],   month = f[x, month] )]) %>% rbindlist()  setnames(ken_2, tolower(names(ken_2))) ken_2 %>% paged_table(options=list(max.print=300)) # Normalize ken_2 <- melt(ken_2, id.vars=c(\"land_use\", \"class\", \"iso3\", \"sheet\", \"year\", \"month\"),   variable.factor=FALSE) # Standardize category names setnames(ken_2, c(\"land_use\", \"class\"), c(\"class\", \"subclass\")) setorder(ken_2, class, subclass, variable, year, month) ken_2[class %in% ken_2[, unique(class)][1]] %>%    ggplot() +   geom_line(aes(as.Date(paste(year, month, 1), \"%Y %m %d\"), value, color=subclass)) +   facet_grid(paste(class, subclass, variable)~., scales=\"free_y\") +   th() +   labs(x=NULL, y=NULL) +   ggtitle(\"WA+ Sheet 2 Variables - Kenya, 2003 to 2017\")"},{"path":"https://github.mbacou.io/WADashboard/articles/02_data-etl.html","id":"sheet-3","dir":"Articles","previous_headings":"Basin-level Aggregates (CSV files) > Variable Inspection","what":"Sheet #3","title":"Data ETL","text":"Similarly inspect results Sheet #3 “Agriculture Services”. Kenya analysis, variables Sheet #3 Sheet #6 available yearly, seasonal, /monthly time-series (across multiple CSV files). (arbitrarily) gather seasonal time-series1: Plotting entire series (6 variables):  gather Sheet #1 Sheet #3 variables long table format. consistency’s sake, encode date_start date_end sheets (incl. yearly monthly variables): generated data cube includes following dimensions: iso3 sheet class subclass variable year month date_start date_end value","code":"f <- data[iso3==\"ken\" & sheet==\"sheet3\" &      str_detect(file, \"season\") & str_detect(file, \"54.0\")] ken_3 <- lapply(1:nrow(f), function(x) fread(f[x, path])[, `:=`(   iso3 = f[x, iso3],   sheet = f[x, sheet],   year = f[x, year],   month = f[x, month],   variable = str_replace(f[x, file], \"sheet3_54.0_\", \"\") %>% str_replace(\"_season.csv\", \"\") )]) %>% rbindlist()  ken_3[, `:=`(   # Drop counter column   V1 = NULL,   # Ensure end of season is last day of month (for consistency with other sheets)   end_dates = end_dates - 1 )][, `:=`(   # Encode year/month columns using end of season   year = year(end_dates),   month = month(end_dates) )]  setnames(ken_3, \"Seasonal\", \"value\") setnames(ken_3, c(\"start_dates\", \"end_dates\"), c(\"date_start\", \"date_end\")) setorder(ken_3, variable, year, month) ken_3 %>% paged_table(options=list(max.print=300)) ken_3 %>%    ggplot() +   geom_line(aes(as.Date(paste(year, month, 1), \"%Y %m %d\"), value, color=variable)) +   facet_grid(variable~., scales=\"free_y\") +   th() +   labs(x=NULL, y=NULL) +   ggtitle(\"WA+ Sheet 3 Variables - Kenya, 2003 to 2017 (seasonal)\") ## Warning: Removed 24 row(s) containing missing values (geom_path). cube <- rbind(mli, ken_1, ken_2, ken_3, fill=TRUE) setcolorder(cube,    c(\"iso3\", \"sheet\", \"class\", \"subclass\", \"variable\",      \"year\", \"month\", \"date_start\", \"date_end\")) cube[is.na(date_start) & is.na(month), `:=`(   # yearly series: 1/1 to 12/31   date_start = as.IDate(paste(year, 1, 1), \"%Y %m %d\"),   date_end = as.IDate(paste(year, 12, 31), \"%Y %m %d\") )][is.na(date_start) & !is.na(month), `:=`(   # monthly series: 1/1 to 1/31   date_start = as.IDate(paste(year, month, 1), \"%Y %m %d\"),   date_end = ceiling_date(as.IDate(paste(year, month, 20), \"%Y %m %d\"), \"months\") - days(1) )]  #saveRDS(cube, \"./data-raw/rds/data.rds\")"},{"path":"https://github.mbacou.io/WADashboard/articles/02_data-etl.html","id":"data-dictionaries","dir":"Articles","previous_headings":"Basin-level Aggregates (CSV files)","what":"Data Dictionaries","title":"Data ETL","text":"Another ETL step required map variable codes used data files visual representation WA+ Sheets (SVG designs). mapping embedded WA+ print_sheet Python module, (example Sheet 1 WAPORWA repo). Importantly many SVG elements fields calculated output variables. might need replicate logic dashboard create dynamic visuals2.","code":"knitr::include_graphics(file.path(\"./fig\", list.files(\"./vignettes/fig\")))"},{"path":"https://github.mbacou.io/WADashboard/articles/02_data-etl.html","id":"sheet-1-1","dir":"Articles","previous_headings":"Basin-level Aggregates (CSV files) > Data Dictionaries","what":"Sheet #1","title":"Data ETL","text":"Field mappings constructed table . Formulas calculated fields replicated . proceed similarly Sheet #2 Sheet #3 mappings.","code":"s1 <- fread(system.file(\"./csv/sheet_1_schema.csv\", package=\"WADashboard\")) %>%    paged_table()"},{"path":[]},{"path":[]},{"path":"https://github.mbacou.io/WADashboard/articles/02_data-etl.html","id":"gridded-variables-netcdf-files","dir":"Articles","previous_headings":"","what":"Gridded Variables (netCDF files)","title":"Data ETL","text":"Gridded variables can used mapping /calculate sub-basin (administrative-level) indicators. Forthcoming…","code":""},{"path":[]},{"path":[]},{"path":[]},{"path":"https://github.mbacou.io/WADashboard/articles/wa_data_etl.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Data ETL for WA+ Dashboard","text":"repository contains server client codes Water Accounting+ visualization dashboard. codes assets provided standard R package. dashboard application written R uses open-source R/Shiny framework. dashboard uses output IWMI WA+ hydrological models, main code routine documented WAPORWA (WaPOR-based Water Accounting). Two hydrological basin provided initial release, lower Niger River Mali Mara River Kenya. differences two use cases, terms data availability temporal scope (e.g. Mali subset entire WAPORWA model obtained), meaning level details available dashboard vary according river basin.","code":""},{"path":[]},{"path":"https://github.mbacou.io/WADashboard/articles/wa_data_etl.html","id":"repository-structure","dir":"Articles","previous_headings":"Technical Guide","what":"Repository Structure","title":"Data ETL for WA+ Dashboard","text":"repo structured standard R package, particular: /data-raw: configuration files /inst: client server scripts web assets Shiny application /R: custom R functions /docs: rendered HTML documentation Inside RStudio IDE application can previewed browser source(\"app.R\"). Shell scripts provided automate common tasks: /build.sh: rebuild install package testing /pkgdown.sh: rebuild HTML package documentation (uses pkgdown framework) /deploy.sh: commit release Github, rebuild Docker image, deploy image AWS ECR","code":""},{"path":[]},{"path":"https://github.mbacou.io/WADashboard/articles/wa_data_etl.html","id":"configuration","dir":"Articles","previous_headings":"Technical Guide","what":"Configuration","title":"Data ETL for WA+ Dashboard","text":"Edit environment variable WA_DATA file ./.Renviron pointing root location WA+ model output (collection CSV NetCDF files). local cloud-based storage type may implemented (incl. Amazon S3). Edit 2 configuration files: List river basins Catalog contextual geospatial layers Rebuild R package reinstall executing ./build.sh.","code":""},{"path":"https://github.mbacou.io/WADashboard/articles/wa_data_etl.html","id":"application-deployment","dir":"Articles","previous_headings":"Technical Guide","what":"Application Deployment","title":"Data ETL for WA+ Dashboard","text":"Docker image file provided deployment AWS ECS (Fargate). image includes Shiny Server Community Edition (development ) RStudio Server Preview. can build test image locally : ’ve established container runs locally, can deployed AWS ECS (see ./deploy.sh automated deployment script): dashboard application served host http://localhost/WADashboard/. RStudio IDE reachable http://localhost:8787/ (replace localhost container’s public IP domain name).","code":"# replace {pwd} with a chosen password for the default rstudio user docker build -t wadashboard . docker run --name wadashboard PASSWORD={pwd} -p 80:3838 -p 8787:8787 wadashboard # Authenticate your local Docker client aws ecr get-login-password --region {region} | docker login --username AWS --password-stdin {aws_account_id}.dkr.ecr.{region}.amazonaws.com # Tag your image with your Amazon ECR registry docker tag wadashboard {aws_account_id}.dkr.ecr.{region}.amazonaws.com/wadashboard # Push the image to your AWS ECR registry docker push {aws_account_id}.dkr.ecr.{region}.amazonaws.com/wadashboard"},{"path":"https://github.mbacou.io/WADashboard/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Melanie Bacou. Author, maintainer. Lisa-Maria Rebelo. Author, contributor. William Rex. Author, contributor. Naga Velpuri. Author, contributor.","code":""},{"path":"https://github.mbacou.io/WADashboard/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Bacou M, Rebelo L, Rex W, Velpuri N (2022). WADashboard: IWMI Water Accounting+ Visualization Dashboard. https://github.com/mbacou/WADashboard/, https://iwmi.cgiar.org/.","code":"@Manual{,   title = {WADashboard: IWMI Water Accounting+ Visualization Dashboard},   author = {Melanie Bacou and Lisa-Maria Rebelo and William Rex and Naga Velpuri},   year = {2022},   note = {https://github.com/mbacou/WADashboard/, https://iwmi.cgiar.org/}, }"},{"path":"https://github.mbacou.io/WADashboard/index.html","id":"visualization-dashboard-for-wa-water-accounts","dir":"","previous_headings":"","what":"IWMI Water Accounting+ Visualization Dashboard","title":"IWMI Water Accounting+ Visualization Dashboard","text":"Development package R/Shiny data visualization tool Water Accounting+ hydrological models. water accounting approach integrates hydrological processes land use, managed water flows services result water consumption river basins. objective achieve equitable transparent water governance users sustainable water balance. Water Accouting+ multi-institutional effort consortium international research centers (IWMI, UNESCO-IHE, FAO, WWAP). institutions neither politically geographically connected river basin.","code":""},{"path":"https://github.mbacou.io/WADashboard/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"IWMI Water Accounting+ Visualization Dashboard","text":"can install package development version GitHub: preview dashboard browser : choose clone repo instead, application can previewed :","code":"if (!require(\"remotes\")) install.packages(\"remotes\") remotes::install_github(\"mbacou/WADashboard\") if (!require(\"shiny\")) install.packages(\"shiny\") shiny::shinyAppDir(system.file(\"app\", package=\"WADashboard\")) shiny::runApp()"},{"path":"https://github.mbacou.io/WADashboard/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"IWMI Water Accounting+ Visualization Dashboard","text":"complete R package documentation, technical guides, deployment tips, see package vignettes.","code":""},{"path":"https://github.mbacou.io/WADashboard/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"IWMI Water Accounting+ Visualization Dashboard","text":"package licensed terms GNU General Public License version 3 later. Copyright 2021-2022 International Water Management Institute (IWMI).","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/DATA.html","id":null,"dir":"Reference","previous_headings":"","what":"Modeled WA+ data cube — DATA","title":"Modeled WA+ data cube — DATA","text":"normalized data.table WA+ variables generated data_etl.","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/DATA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Modeled WA+ data cube — DATA","text":"","code":"DATA"},{"path":"https://github.mbacou.io/WADashboard/reference/DATA.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Modeled WA+ data cube — DATA","text":"data.table columns: iso3 sheet class subclass variable date_start date_end year month unit value","code":""},{"path":[]},{"path":"https://github.mbacou.io/WADashboard/reference/DATA.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Modeled WA+ data cube — DATA","text":"","code":"names(DATA) #>  [1] \"iso3\"       \"sheet\"      \"class\"      \"subclass\"   \"variable\"   #>  [6] \"year\"       \"month\"      \"date_start\" \"date_end\"   \"value\"      DATA[1:5] #>    iso3  sheet  class      subclass                variable year month #> 1:  mli sheet1 INFLOW PRECIPITATION                Rainfall 2010    NA #> 2:  mli sheet1 INFLOW PRECIPITATION                Snowfall 2010    NA #> 3:  mli sheet1 INFLOW PRECIPITATION Precipitation recycling 2010    NA #> 4:  mli sheet1 INFLOW SURFACE WATER          Main riverstem 2010    NA #> 5:  mli sheet1 INFLOW SURFACE WATER             Tributaries 2010    NA #>    date_start   date_end  value #> 1: 2010-01-01 2010-12-31 434.99 #> 2: 2010-01-01 2010-12-31   0.00 #> 3: 2010-01-01 2010-12-31   0.00 #> 4: 2010-01-01 2010-12-31   0.00 #> 5: 2010-01-01 2010-12-31   0.00"},{"path":"https://github.mbacou.io/WADashboard/reference/ISO3.html","id":null,"dir":"Reference","previous_headings":"","what":"River basins — ISO3","title":"River basins — ISO3","text":"named list basin metadata. Names basin's largest country ISO3 codes. list read package configuration file ./data-raw/json/ISO3.json. file may manually edited add new basin configurations.","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/ISO3.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"River basins — ISO3","text":"","code":"ISO3"},{"path":"https://github.mbacou.io/WADashboard/reference/ISO3.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"River basins — ISO3","text":"named list, names 3-letter ISO3 country codes.","code":""},{"path":[]},{"path":"https://github.mbacou.io/WADashboard/reference/ISO3.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"River basins — ISO3","text":"","code":"# Processed river basins names(ISO3) #> [1] \"mli\" \"ken\"  # Metadata terms currently in use for each basin ISO3[[1]] #> $label #> [1] \"Niger River\" #>  #> $source #> $source[[1]] #> [1] \"./csv_km3\" #>  #>  #> $admin #> [1] \"./data-raw/json/mli_basin.geojson\" #>  #> $water #> [1] \"./data-raw/json/mli_gloric.geojson\" #>  #> $country #> [1] \"Mali\" #>  #> $countries #> [1] 4 #>  #> $unit #> [1] \"km3\" #>  #> $area #> [1] 40000 #>  #> $`irrigated area` #> [1] 400 #>  #> $population #> [1] 800000 #>  #> $authorities #> [1] \"Niger Basin Authority\" #>  #> $url #> [1] \"http://www.sath.abn.ne/\" #>  #> $`annual rainfall` #> [1] 600 #>  #> $`annual ET` #> [1] 400 #>  #> $`major season` #> [1] \"Apr-Sep\" #>  #> $`minor season` #> [1] \"Oct-Dec\" #>  #> $`major dams` #> [1] 5 #>  #> $`hydro power` #> [1] 60 #>"},{"path":"https://github.mbacou.io/WADashboard/reference/LAYERS.html","id":null,"dir":"Reference","previous_headings":"","what":"WMS and map tile providers — LAYERS","title":"WMS and map tile providers — LAYERS","text":"Named list 3rd-party geospatial layers. default layers read package configuration file ./data-raw/json/LAYERS.json. file may manually edited add new layers dashboard. spatial formats supported Leaflet JS viewer allowed (e.g. raster tiles, WMS, GeoJSON, KML, etc.). vector tiles supported currently.","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/LAYERS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"WMS and map tile providers — LAYERS","text":"","code":"LAYERS"},{"path":"https://github.mbacou.io/WADashboard/reference/LAYERS.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"WMS and map tile providers — LAYERS","text":"named list, names provider codes.","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/LAYERS.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"WMS and map tile providers — LAYERS","text":"list organized data provider (e.g. Digital Earth Africa, ESRI World Atlas, FAO WaPOR, Google Earth Engine, etc.).","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/LAYERS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"WMS and map tile providers — LAYERS","text":"","code":"LAYERS[[2]] #> $label #> [1] \"FAO WaPOR GeoServer\" #>  #> $url #> [1] \"https://io.apps.fao.org/geoserver/wms?\" #>  #> $legend #> [1] \"https://io.apps.fao.org/geoserver/wms?request=GetLegendGraphic&format=image/png&layer=%s\" #>  #> $info #> [1] \"Description\" #>  #> $attr #> [1] \"FAO WaPOR\" #>  #> $layers #> $layers$`Natural Earth` #> [1] \"RICCAR:gray_hr_sr_w_3\" #>  #> $layers$`Blue Marble` #> [1] \"NASA:bluemarble_ls_sw_st\" #>  #> $layers$`Hydrological Basins` #> [1] \"AQUAMAPS:hydrobasins_africa\" #>  #> $layers$`Major Rivers` #> [1] \"AQUAMAPS:rivers_africa\" #>  #> $layers$`Total Population` #> [1] \"WPOP:wpop_t\" #>  #> $layers$`Precipitation (annual) 5km` #> [1] \"WAPOR_2:l1_pcp_a\" #>  #> $layers$`Precipitation Anomaly (monthly)` #> [1] \"NMME:fmpa\" #>  #> $layers$`Evaporation (dekadal) 250m` #> [1] \"WAPOR_2:l1_e_d\" #>  #> $layers$`Evapotranspiration (dekadal) 250m` #> [1] \"C3S:agera5_et0_d\" #>  #> $layers$`Actual ET (annual) 100m` #> [1] \"WAPOR_2:l2_aeti_a\" #>  #> $layers$`Incremental ET - Niger (monthly) 100m` #> [1] \"WATER:niger_etincr\" #>  #> $layers$`Incremental ET - Nile (monthly) 100m` #> [1] \"WATER:niger_etincr\" #>  #> $layers$`Drought Intensity (dekadal)` #> [1] \"ASIS:di_d\" #>  #> $layers$`Agricultural Stress Index (dekadal)` #> [1] \"ASIS:asi_d\" #>  #> $layers$`Land Cover (annual) 100m` #> [1] \"WAPOR_2:l2_lcc_a\" #>  #> $layers$`Land Use - Niger (annual) 100m` #> [1] \"WATER:niger_lus\" #>  #> $layers$`Land Use - Nile (annual) 100m` #> [1] \"WATER:nile_lus\" #>  #>"},{"path":"https://github.mbacou.io/WADashboard/reference/WADashboard-package.html","id":null,"dir":"Reference","previous_headings":"","what":"WADashboard: IWMI Water Accounting+ Visualization Dashboard — WADashboard-package","title":"WADashboard: IWMI Water Accounting+ Visualization Dashboard — WADashboard-package","text":"package includes dependencies run WA+ visualization dashboard either locally inside RStudio containerized.","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/WADashboard-package.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"WADashboard: IWMI Water Accounting+ Visualization Dashboard — WADashboard-package","text":"R package Shiny-based Water Accounting Plus dashboard application package exposes options: wa.data: user-defined path download remote spatio-temporal raster files","code":""},{"path":[]},{"path":"https://github.mbacou.io/WADashboard/reference/WADashboard-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"WADashboard: IWMI Water Accounting+ Visualization Dashboard — WADashboard-package","text":"Maintainer: Melanie Bacou mel@mbacou.com (ORCID) Authors: Lisa-Maria Rebelo L.REBELO@CGIAR.ORG (ORCID) [contributor] William Rex W.Rex@cgiar.org (ORCID) [contributor] Naga Velpuri N.Velpuri@cgiar.org (ORCID) [contributor]","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/ZOI.html","id":null,"dir":"Reference","previous_headings":"","what":"Basin boundaries — ZOI","title":"Basin boundaries — ZOI","text":"Named list simplified basin boundaries water stream networks sf objects, read GeoJSON file locations defined ISO3.","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/ZOI.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Basin boundaries — ZOI","text":"","code":"ZOI"},{"path":"https://github.mbacou.io/WADashboard/reference/ZOI.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Basin boundaries — ZOI","text":"named list, names 3-letter ISO3 country codes.","code":""},{"path":[]},{"path":"https://github.mbacou.io/WADashboard/reference/ZOI.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Basin boundaries — ZOI","text":"","code":"par(mfrow=c(1, length(ZOI))) for(i in ZOI) {  plot(st_geometry(i[[\"admin\"]]), col=pal[\"light\"])  plot(st_geometry(i[[\"water\"]]), col=pal[\"blue\"], add=T) } #> Error in st_geometry(i[[\"admin\"]]): could not find function \"st_geometry\""},{"path":"https://github.mbacou.io/WADashboard/reference/accordion.html","id":null,"dir":"Reference","previous_headings":"","what":"Bootstrap 4 accordion — accordion","title":"Bootstrap 4 accordion — accordion","text":"modified version bs4Dash::accordion(). accordionItem inserted accordion container. modified version bs4Dash::accordionItem(). Change selected value accordion input client. Copied bs4Dash::updateAccordion().","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/accordion.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bootstrap 4 accordion — accordion","text":"","code":"accordion(..., id, width = 12)  accordionItem(   ...,   title = NULL,   icon = NULL,   status = NULL,   collapsed = TRUE,   solidHeader = TRUE,   class = NULL,   bg = NULL )  updateAccordion(id, selected, session = getDefaultReactiveDomain())"},{"path":"https://github.mbacou.io/WADashboard/reference/accordion.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bootstrap 4 accordion — accordion","text":"... slot accordionItem. id unique accordion id. width width accordion. title Optional title. icon optional icon status status item. determines item's background   color.  Valid statuses defined follows: primary: #007bff . secondary: #6c757d . info: #17a2b8 . success: #28a745 . warning: #ffc107 . danger: #dc3545 . gray-dark: #343a40 . gray: #adb5bd . white: #fff . indigo: #6610f2 . lightblue: #3c8dbc . navy: #001f3f . purple: #605ca8 . fuchsia: #f012be . pink: #e83e8c . maroon: #d81b60 . orange: #ff851b . lime: #01ff70 . teal: #39cccc . olive: #3d9970 . collapsed TRUE, start collapsed. must used collapsible=TRUE. solidHeader header shown solid color background? class additional classes apply parent card element bg background color selected Index newly selected accordionItem. session Shiny session object.","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/boxplot_ecc.html","id":null,"dir":"Reference","previous_headings":"","what":"Boxplot yearly ECC time-series (highcharts) — boxplot_ecc","title":"Boxplot yearly ECC time-series (highcharts) — boxplot_ecc","text":"Boxplot yearly ECC time-series (highcharts)","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/boxplot_ecc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Boxplot yearly ECC time-series (highcharts) — boxplot_ecc","text":"","code":"boxplot_ecc(   data,   prob = 0.95,   title = \"Historical Claim Costs across Years\",   subtitle = \"As percent of limit, 2001-2019 average ECC with VaR line in red\",   ... )"},{"path":"https://github.mbacou.io/WADashboard/reference/boxplot_ecc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Boxplot yearly ECC time-series (highcharts) — boxplot_ecc","text":"data output wc_ecc prob percentile threshold(s) draw charts title chart title subtitle chart subtitle","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/boxplot_ecc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Boxplot yearly ECC time-series (highcharts) — boxplot_ecc","text":"","code":"data <- data.table(   year = rep(2001:2020, each=5),   ecc = sample(1:100/100, 5*20, replace=T)   ) #> Error in data.table(year = rep(2001:2020, each = 5), ecc = sample(1:100/100,     5 * 20, replace = T)): could not find function \"data.table\" boxplot_ecc(data) #> Error in .(prob = prob, ecc = quantile(ecc, prob, na.rm = T)): could not find function \".\""},{"path":"https://github.mbacou.io/WADashboard/reference/bs_themed.html","id":null,"dir":"Reference","previous_headings":"","what":"Custom Bootstrap theme — bs_themed","title":"Custom Bootstrap theme — bs_themed","text":"modified Bootstrap 4 theme based IWMI branding guidelines.","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/bs_themed.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Custom Bootstrap theme — bs_themed","text":"","code":"bs_themed(   base_font = \"'national-web-book'\",   heading_font = \"'DM Serif Text'\",   font_size = 15,   palette = pal,   elevation = 0,   rounded = FALSE,   gradients = FALSE )"},{"path":"https://github.mbacou.io/WADashboard/reference/bs_themed.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Custom Bootstrap theme — bs_themed","text":"base_font default typeface. heading_font typeface used heading elements. font_size base font size pixel palette color palette (list Bootstrap colors) (see pal) elevation default element shadow depth (see BS4 shadows) rounded enable rounded elements (see BS4 borders) gradients enable background gradients (see BS4 colors)","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/bs_themed.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Custom Bootstrap theme — bs_themed","text":"Modified Bootstrap 4 theme","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/bs_themed.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Custom Bootstrap theme — bs_themed","text":"","code":"if(interactive()) bs_theme_preview(bs_themed())"},{"path":"https://github.mbacou.io/WADashboard/reference/data_etl.html","id":null,"dir":"Reference","previous_headings":"","what":"Main data ETL — data_etl","title":"Main data ETL — data_etl","text":"Main ETL ingest WA+ modeled result sets found location defined getOption(\"wa.data\"). location may specified run time via environment variable WA_DATA. Exact location structure output data files still defined.","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/data_etl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Main data ETL — data_etl","text":"","code":"data_etl(   iso3 = NULL,   root = getOption(\"wa.data\"),   file = file.path(\"./data-raw/rds/data.rds\") )"},{"path":"https://github.mbacou.io/WADashboard/reference/data_etl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Main data ETL — data_etl","text":"iso3 3-letter country code river basin ingest. null, basin ISO3 listed ISO3 processed. Can used manually test new result sets. root base directory (local remote) scan input data files (default: package option getOption(\"wa.data\") environment variable WA_DATA set) file connection name file R object saved . default behavior save transformed dataset package's ./data-raw folder, include built-package dataset (done automatically package build, see DATA).","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/data_etl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Main data ETL — data_etl","text":"normalized data.table variables: -","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/data_etl.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Main data ETL — data_etl","text":"vignette available describe current approach.","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/data_etl.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Main data ETL — data_etl","text":"","code":"data <- data_etl(\"mli\") #> Error in formal.args[[as.character(substitute(arg))]]: no such index at level 1"},{"path":"https://github.mbacou.io/WADashboard/reference/etl.html","id":null,"dir":"Reference","previous_headings":"","what":"Main data ETL — etl","title":"Main data ETL — etl","text":"Main ETL ingest raw datasets found root. Shiny application checks new input data files executes script necessary. Exact location structure input data files still defined.","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/etl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Main data ETL — etl","text":"","code":"etl(root = getOption(\"wa.data\"), file = NULL, ...)"},{"path":"https://github.mbacou.io/WADashboard/reference/etl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Main data ETL — etl","text":"root base directory (local remote) scan input data files (default: package option getOption(\"wa.data\") environment variable WA_DATA_ROOT set) file connection name file R object     saved read . ... Arguments passed base::saveRDS object R object serialize. ascii logical.  TRUE NA, ASCII     representation written; otherwise (default), binary one used.     See comments help save. version workspace format version use.  NULL     specifies current default version (3). supported     value 2, default R 1.4.0 R 3.5.0. compress logical specifying whether saving named file     use \"gzip\" compression, one \"gzip\",     \"bzip2\" \"xz\" indicate type compression     used.  Ignored file connection. refhook hook function handling reference objects.","code":""},{"path":[]},{"path":[]},{"path":"https://github.mbacou.io/WADashboard/reference/hc_themed.html","id":null,"dir":"Reference","previous_headings":"","what":"Custom HighCharts theme — hc_themed","title":"Custom HighCharts theme — hc_themed","text":"Custom HighCharts theme","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/hc_themed.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Custom HighCharts theme — hc_themed","text":"","code":"hc_themed(   hc,   title = NULL,   subtitle = NULL,   label = NULL,   x = NULL,   y = NULL,   base_font = getOption(\"wa.font\"),   axes = TRUE,   exporting = TRUE,   credits = FALSE,   ... )"},{"path":"https://github.mbacou.io/WADashboard/reference/hc_themed.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Custom HighCharts theme — hc_themed","text":"hc highchart object title chart title subtitle chart subtitle label optional annotation base_font default font chart elements axes show axes (default: TRUE) exporting include chart export menu (default: TRUE) credits include credits (default: FALSE) ... Arguments passed highcharter::hc_theme","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/hc_ts.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot dekadal index time series with trends (highcharts) — hc_ts","title":"Plot dekadal index time series with trends (highcharts) — hc_ts","text":"Plot dekadal index time series trends (highcharts)","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/hc_ts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot dekadal index time series with trends (highcharts) — hc_ts","text":"","code":"hc_ts(   data,   type = c(\"precipitation\", \"temperature\"),   yrange = NULL,   title = \"Long-Term Cumulative Rainfall by Dekad\",   subtitle = \"Average across portfolio locations, 1990-2020 (mm)\",   ... )"},{"path":"https://github.mbacou.io/WADashboard/reference/hc_ts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot dekadal index time series with trends (highcharts) — hc_ts","text":"data biophysical time-series (output wc_extract) type precipitation temperature variable yrange y-axis min max title chart title subtitle chart subtitle","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/hc_ts.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot dekadal index time series with trends (highcharts) — hc_ts","text":"","code":"dt <- readRDS(file.path(getOption(\"wc.shared\"), \"tmp\", \"2020-burn_lockton_bio.rds\")) #> Error in gzfile(file, \"rb\"): invalid 'description' argument plot_ts(dt[code==\"bom_rain\"]) #> Error in hc_add_series(., dt, type = \"area\", hcaes(x = date_end, y = value),     name = dt[1, variable], color = color, fillColor = alpha(color,         0.2), marker = list(enabled = TRUE)): object 'code' not found"},{"path":"https://github.mbacou.io/WADashboard/reference/l_admin.html","id":null,"dir":"Reference","previous_headings":"","what":"Format district picklist — l_admin","title":"Format district picklist — l_admin","text":"Format district picklist","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/l_admin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format district picklist — l_admin","text":"","code":"l_admin(iso3 = names(ISO3))"},{"path":"https://github.mbacou.io/WADashboard/reference/l_admin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format district picklist — l_admin","text":"iso3 Basin ISO3 code (see ISO3)","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/l_admin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Format district picklist — l_admin","text":"list html tags","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/l_admin.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Format district picklist — l_admin","text":"","code":"l_admin(\"ken\") #> $Arusha #> Ngorongoro  #>     190510  #>  #> $Mara #> Administrative unit not available                             Bunda  #>                            190523                             48430  #>                           Butiama                             Rorya  #>                            115094                            115093  #>                         Serengeti                            Tarime  #>                             48433                            115039  #>  #> $Nyanza #> Kuria  #> 51370  #>  #> $`Rift Valley` #>      Bomet      Buret     Nakuru      Narok Trans Mara  #>      51378      51379      51386      51388      51390  #>"},{"path":"https://github.mbacou.io/WADashboard/reference/l_iso3.html","id":null,"dir":"Reference","previous_headings":"","what":"Format basin picklist — l_iso3","title":"Format basin picklist — l_iso3","text":"Format basin picklist","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/l_iso3.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format basin picklist — l_iso3","text":"","code":"l_iso3()"},{"path":"https://github.mbacou.io/WADashboard/reference/l_iso3.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Format basin picklist — l_iso3","text":"list html tags","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/lmap_init.html","id":null,"dir":"Reference","previous_headings":"","what":"Initialize map (Mapbox GL) — lmap_init","title":"Initialize map (Mapbox GL) — lmap_init","text":"Load basin boundaries default configuration.","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/lmap_init.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Initialize map (Mapbox GL) — lmap_init","text":"","code":"lmap_init(   iso3 = names(ISO3),   mapbox_key = getOption(\"wa.mapbox\"),   maptiler_key = getOption(\"wa.maptiler\") )"},{"path":"https://github.mbacou.io/WADashboard/reference/lmap_init.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Initialize map (Mapbox GL) — lmap_init","text":"iso3 3-letter country code center map (see ISO3) mapbox_key Mapbox API key (default getOption(\"wa.mapbox\")) maptiler_key Maptiler API key (default getOption(\"wa.maptiler\"))","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/lmap_init.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Initialize map (Mapbox GL) — lmap_init","text":"Mapbox GL map widget default layers","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/lmap_init.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Initialize map (Mapbox GL) — lmap_init","text":"","code":"# Default rendering map_init() #> Error in floor_date(date, \"month\"): could not find function \"floor_date\""},{"path":"https://github.mbacou.io/WADashboard/reference/lmap_update.html","id":null,"dir":"Reference","previous_headings":"","what":"Update map (Mapbox GL) — lmap_update","title":"Update map (Mapbox GL) — lmap_update","text":"Add selected hydrological features across river basins.","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/lmap_update.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Update map (Mapbox GL) — lmap_update","text":"","code":"lmap_update(m, iso3 = names(ISO3))"},{"path":"https://github.mbacou.io/WADashboard/reference/lmap_update.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Update map (Mapbox GL) — lmap_update","text":"m leaflet map iso3 3-letter country code update map (see ISO3)","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/lmap_update.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Update map (Mapbox GL) — lmap_update","text":"Mapbox map widget","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/map_init.html","id":null,"dir":"Reference","previous_headings":"","what":"Initialize Leafet map and 3rd-party spatiotemporal layers — map_init","title":"Initialize Leafet map and 3rd-party spatiotemporal layers — map_init","text":"Load basin boundaries default configuration. Add selected hydrological features across river basins. Used toggle 3rd-party contextual layers.","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/map_init.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Initialize Leafet map and 3rd-party spatiotemporal layers — map_init","text":"","code":"map_init(iso3 = names(ISO3), key = getOption(\"wa.maptiler\"))  map_update(map, iso3 = names(ISO3))  map_toggle(map, layers = NULL)"},{"path":"https://github.mbacou.io/WADashboard/reference/map_init.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Initialize Leafet map and 3rd-party spatiotemporal layers — map_init","text":"iso3 3-letter country code update map (see ISO3) key Maptiler API key map leaflet map layers vector layer names (see LAYERS)","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/map_init.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Initialize Leafet map and 3rd-party spatiotemporal layers — map_init","text":"leaflet map widget default layers leaflet map widget default layers updated leaflet map","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/map_init.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Initialize Leafet map and 3rd-party spatiotemporal layers — map_init","text":"","code":"# Default rendering map_init() #> Error in floor_date(date, \"month\"): could not find function \"floor_date\""},{"path":"https://github.mbacou.io/WADashboard/reference/pal.html","id":null,"dir":"Reference","previous_headings":"","what":"Custom color palette — pal","title":"Custom color palette — pal","text":"list Bootstrap color codes. default colors read package configuration file ./data-raw/json/palette.gpl (GIMP palette format).","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/pal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Custom color palette — pal","text":"","code":"pal"},{"path":"https://github.mbacou.io/WADashboard/reference/pal.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Custom color palette — pal","text":"named character vector","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/pal.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Custom color palette — pal","text":"","code":"names(pal) #>  [1] \"navy\"       \"light-blue\" \"blue\"       \"teal\"       \"green\"      #>  [6] \"orange\"     \"red\"        \"maroon\"     \"purple\"     \"yellow\"     #> [11] \"black\"      \"light\"      scales::show_col(pal, borders=\"#ffffff\")"},{"path":"https://github.mbacou.io/WADashboard/reference/plot_bullet.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot bullet charts — plot_bullet","title":"Plot bullet charts — plot_bullet","text":"Plot bullet charts","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/plot_bullet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot bullet charts — plot_bullet","text":"","code":"plot_bullet(data)"},{"path":"https://github.mbacou.io/WADashboard/reference/plot_bullet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot bullet charts — plot_bullet","text":"data input data ... Arguments passed hc_themed hc highchart object title chart title subtitle chart subtitle label optional annotation base_font default font chart elements axes show axes (default: TRUE) exporting include chart export menu (default: TRUE) credits include credits (default: FALSE)","code":""},{"path":[]},{"path":"https://github.mbacou.io/WADashboard/reference/plot_clim.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot dekadal index time series (highcharts) — plot_clim","title":"Plot dekadal index time series (highcharts) — plot_clim","text":"Plot dekadal index time series (highcharts)","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/plot_clim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot dekadal index time series (highcharts) — plot_clim","text":"","code":"plot_clim(   data,   type = c(\"precipitation\", \"tmin\", \"tmax\"),   sos = switch(type, precipitation = 35, 2),   yrange = NULL,   title = \"Climate Normals by Dekad\",   subtitle = \"Average across portfolio locations, 1990-2020 (mm)\",   ... )"},{"path":"https://github.mbacou.io/WADashboard/reference/plot_clim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot dekadal index time series (highcharts) — plot_clim","text":"data biophysical time-series (output wc_extract()) type index type tp (precipitation) temp (temperature) sos start season threshold (default: 35 mm 8°C Tmin blooming) yrange y-axis min max title chart title subtitle chart subtitle","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/plot_clim.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot dekadal index time series (highcharts) — plot_clim","text":"","code":"dt <- readRDS(file.path(getOption(\"wc.shared\"), \"tmp\", \"2020-burn_lockton_bio.rds\")) #> Error in gzfile(file, \"rb\"): invalid 'description' argument plot_clim(dt[code==\"bom_rain\"]) #> Error in plot_clim(dt[code == \"bom_rain\"]): object 'code' not found"},{"path":"https://github.mbacou.io/WADashboard/reference/plot_cor.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot correlation matrix (highcharts) — plot_cor","title":"Plot correlation matrix (highcharts) — plot_cor","text":"Plot correlation matrix (highcharts)","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/plot_cor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot correlation matrix (highcharts) — plot_cor","text":"","code":"plot_cor(data, title = NA, subtitle = NA, ...)"},{"path":"https://github.mbacou.io/WADashboard/reference/plot_cor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot correlation matrix (highcharts) — plot_cor","text":"data output wc_ecc title chart title subtitle chart subtitle ... Arguments passed hc_themed hc highchart object label optional annotation base_font default font chart elements axes show axes (default: TRUE) exporting include chart export menu (default: TRUE) credits include credits (default: FALSE)","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/plot_cor.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot correlation matrix (highcharts) — plot_cor","text":"","code":"data <- data.table(   ecc_grm = rnorm(20),   ecc_cdd = rnorm(20),   ecc_crf = rnorm(20),   ecc_crd = rnorm(20),   ecc_crw = rnorm(20) ) #> Error in data.table(ecc_grm = rnorm(20), ecc_cdd = rnorm(20), ecc_crf = rnorm(20),     ecc_crd = rnorm(20), ecc_crw = rnorm(20)): could not find function \"data.table\" plot_cor(data) #> Error in .(grm = ecc_grm > 0, cdd = ecc_cdd > 0, crf = ecc_crf > 0, crd = ecc_crd >     0, crw = ecc_crw > 0, erd = ecc_erd > 0, fdd = ecc_fdd >     0): could not find function \".\""},{"path":"https://github.mbacou.io/WADashboard/reference/plot_ecc.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot yearly ECC time-series (highcharts) — plot_ecc","title":"Plot yearly ECC time-series (highcharts) — plot_ecc","text":"Plot yearly ECC time-series (highcharts)","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/plot_ecc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot yearly ECC time-series (highcharts) — plot_ecc","text":"","code":"plot_ecc(   data,   title = \"Historical Claim Costs across Perils\",   subtitle = \"As percent of limit, 2001-2019 average ECC\",   ... )"},{"path":"https://github.mbacou.io/WADashboard/reference/plot_ecc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot yearly ECC time-series (highcharts) — plot_ecc","text":"data output wc_ecc title chart title subtitle chart subtitle","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/plot_ecc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot yearly ECC time-series (highcharts) — plot_ecc","text":"","code":"data <- data.table(   year = rep(2001:2020, each=5),   ecc = sample(1:100/100, 5*20, replace=T),   ecc_dr = sample(1:100/100, 5*20, replace=T),   ecc_xs = sample(1:100/100, 5*20, replace=T),   ecc_tp = sample(1:100/100, 5*20, replace=T),   weight = sample(1:100/100, 5*20, replace=T)   ) #> Error in data.table(year = rep(2001:2020, each = 5), ecc = sample(1:100/100,     5 * 20, replace = T), ecc_dr = sample(1:100/100, 5 * 20,     replace = T), ecc_xs = sample(1:100/100, 5 * 20, replace = T),     ecc_tp = sample(1:100/100, 5 * 20, replace = T), weight = sample(1:100/100,         5 * 20, replace = T)): could not find function \"data.table\" plot_ecc(data) #> Error in `:=`(year, as.character(year)): Check that is.data.table(DT) == TRUE. Otherwise, := and `:=`(...) are defined for use in j, once only and in particular ways. See help(\":=\")."},{"path":"https://github.mbacou.io/WADashboard/reference/plot_ecc_density.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot yearly ECC density (highcharts) — plot_ecc_density","title":"Plot yearly ECC density (highcharts) — plot_ecc_density","text":"Plot yearly ECC density (highcharts)","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/plot_ecc_density.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot yearly ECC density (highcharts) — plot_ecc_density","text":"","code":"plot_ecc_density(   data,   prob = 0.95,   title = \"Probability Density of Claim Costs\",   subtitle = \"As percent of limit, 2001-2019 average ECC with %s VaR\",   ... )"},{"path":"https://github.mbacou.io/WADashboard/reference/plot_ecc_density.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot yearly ECC density (highcharts) — plot_ecc_density","text":"data output wc_ecc prob percentile threshold(s) draw title chart title subtitle chart subtitle","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/plot_idx.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot yearly index time series with EMA trends (highcharts) — plot_idx","title":"Plot yearly index time series with EMA trends (highcharts) — plot_idx","text":"Plot yearly index time series EMA trends (highcharts)","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/plot_idx.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot yearly index time series with EMA trends (highcharts) — plot_idx","text":"","code":"plot_idx(   data,   title = \"Index Trend\",   subtitle = \"Average across portfolio locations with EMA trend, 1990-2020 (mm)\",   label = NULL,   rowheight = 280,   ncol = 1,   ... )"},{"path":"https://github.mbacou.io/WADashboard/reference/plot_idx.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot yearly index time series with EMA trends (highcharts) — plot_idx","text":"data output wc_trg_*, see examples title chart title subtitle chart subtitle label optional annotation rowheight Height px. ncol many columns grid ... Arguments passed hc_themed hc highchart object base_font default font chart elements axes show axes (default: TRUE) exporting include chart export menu (default: TRUE) credits include credits (default: FALSE)","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/plot_idx.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot yearly index time series with EMA trends (highcharts) — plot_idx","text":"","code":"dt <- data.table(  loc_id = 1:3,  period = rep(c(\"prd_1\", \"prd_5\"), 3),  year = rep(1990:2020, each=3*2),  idx = rnorm(31*3*2, 10),  idx_lo = 8,  idx_hi = 12,  ecc = rnorm(31*3*2, .5) ) #> Error in data.table(loc_id = 1:3, period = rep(c(\"prd_1\", \"prd_5\"), 3),     year = rep(1990:2020, each = 3 * 2), idx = rnorm(31 * 3 *         2, 10), idx_lo = 8, idx_hi = 12, ecc = rnorm(31 * 3 *         2, 0.5)): could not find function \"data.table\" plot_idx(dt) #> Error in .(idx = mean(idx, na.rm = T), sd = sd(idx, na.rm = T), idx_lo = round(mean(idx_lo,     na.rm = T)), idx_hi = round(mean(idx_hi, na.rm = T)), ecc = mean(ecc,     na.rm = T)): could not find function \".\""},{"path":"https://github.mbacou.io/WADashboard/reference/plot_idx_density.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot index density (highcharts) — plot_idx_density","title":"Plot index density (highcharts) — plot_idx_density","text":"Plot index density (highcharts)","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/plot_idx_density.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot index density (highcharts) — plot_idx_density","text":"","code":"plot_idx_density(   data,   title = \"Index Density Distribution\",   subtitle = \"Across portfolio locations, 1990-2020 (mm)\",   rowheight = 280,   ncol = 1,   ... )"},{"path":"https://github.mbacou.io/WADashboard/reference/plot_idx_density.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot index density (highcharts) — plot_idx_density","text":"data output wc_trg_* title chart title subtitle chart subtitle rowheight Height px. ncol many columns grid ... Arguments passed hc_themed hc highchart object label optional annotation base_font default font chart elements axes show axes (default: TRUE) exporting include chart export menu (default: TRUE) credits include credits (default: FALSE)","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/plot_idx_density.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot index density (highcharts) — plot_idx_density","text":"","code":"dt <- data.table(  loc_id = 1:3,  period = rep(c(\"prd_1\", \"prd_5\"), 3),  year = rep(1990:2020, each=3*2),  idx = rnorm(31*3*2, 10),  idx_lo = 8,  idx_hi = 12 ) #> Error in data.table(loc_id = 1:3, period = rep(c(\"prd_1\", \"prd_5\"), 3),     year = rep(1990:2020, each = 3 * 2), idx = rnorm(31 * 3 *         2, 10), idx_lo = 8, idx_hi = 12): could not find function \"data.table\" plot_idx_density(dt) #> Error in deparse(...): unused argument (by = \"period\")"},{"path":"https://github.mbacou.io/WADashboard/reference/plot_idx_mosaic.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot temperature indices (highcharts) — plot_idx_mosaic","title":"Plot temperature indices (highcharts) — plot_idx_mosaic","text":"Plot temperature indices (highcharts)","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/plot_idx_mosaic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot temperature indices (highcharts) — plot_idx_mosaic","text":"","code":"plot_idx_mosaic(data, title = NA, subtitle = NA, ...)"},{"path":"https://github.mbacou.io/WADashboard/reference/plot_idx_mosaic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot temperature indices (highcharts) — plot_idx_mosaic","text":"data output wc_trg* title chart title subtitle chart subtitle ... Arguments passed hc_themed hc highchart object label optional annotation base_font default font chart elements axes show axes (default: TRUE) exporting include chart export menu (default: TRUE) credits include credits (default: FALSE)","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/plot_idx_mosaic.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot temperature indices (highcharts) — plot_idx_mosaic","text":"","code":"data <- data.table(   year = rep(2000:2010, each=10),   loc_id = 1:10,   idx = rnorm(10, mean=80) ) #> Error in data.table(year = rep(2000:2010, each = 10), loc_id = 1:10, idx = rnorm(10,     mean = 80)): could not find function \"data.table\" plot_idx_mosaic(data) #> Error: Objects of class/type function are not supported by hchart (yet)."},{"path":"https://github.mbacou.io/WADashboard/reference/plot_rcp.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot product recipes (highcharts) — plot_rcp","title":"Plot product recipes (highcharts) — plot_rcp","text":"Plot product recipes (highcharts)","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/plot_rcp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot product recipes (highcharts) — plot_rcp","text":"","code":"plot_rcp(   args,   x = NULL,   title = \"Coverage Periods and Payout Factors | %s\",   subtitle = \"Range of payout factors by index type (% of S.I.)\",   ... )"},{"path":"https://github.mbacou.io/WADashboard/reference/plot_rcp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot product recipes (highcharts) — plot_rcp","text":"args pricing arguments x (optional) location ID (loc_id) draw title chart title subtitle chart subtitle","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/plot_rcp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot product recipes (highcharts) — plot_rcp","text":"","code":"pts <- data.table(loc_id=1, X=1, Y=1, day=\"2020-03-02\") #> Error in data.table(loc_id = 1, X = 1, Y = 1, day = \"2020-03-02\"): could not find function \"data.table\" args <- wc_args(pts, crop=\"maiz\", pay_grm=.3) #> Error in wc_args(pts, crop = \"maiz\", pay_grm = 0.3): could not find function \"wc_args\" plot_rcp(args) #> Error: object of type 'closure' is not subsettable"},{"path":"https://github.mbacou.io/WADashboard/reference/plot_tick.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot payout curves (highcharts) — plot_tick","title":"Plot payout curves (highcharts) — plot_tick","text":"Plot payout curves (highcharts)","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/plot_tick.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot payout curves (highcharts) — plot_tick","text":"","code":"plot_tick(data, title = NA, subtitle = NA, rowheight = 200, ...)"},{"path":"https://github.mbacou.io/WADashboard/reference/plot_tick.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot payout curves (highcharts) — plot_tick","text":"data output wc_price 1 trigger location (single contract) title chart title subtitle chart subtitle rowheight Height px. ... Arguments passed hc_themed hc highchart object label optional annotation base_font default font chart elements axes show axes (default: TRUE) exporting include chart export menu (default: TRUE) credits include credits (default: FALSE) args pricing arguments","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/plot_tick.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot payout curves (highcharts) — plot_tick","text":"","code":"pts <- data.table(loc_id=1, X=30, Y=-17, day=\"2020-12-01\") #> Error in data.table(loc_id = 1, X = 30, Y = -17, day = \"2020-12-01\"): could not find function \"data.table\" args <- wc_args(pts, product=\"MAIZ-ZWE-05-CB01\", code=\"rfe\") #> Error in wc_args(pts, product = \"MAIZ-ZWE-05-CB01\", code = \"rfe\"): could not find function \"wc_args\" data <- wc_price(args=args) #> Error in wc_price(args = args): could not find function \"wc_price\" plot_tick(data, args) #> Error in unique(period): object 'period' not found"},{"path":"https://github.mbacou.io/WADashboard/reference/plot_timeline.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot monthly basin time series (highcharts) — plot_timeline","title":"Plot monthly basin time series (highcharts) — plot_timeline","text":"Plot monthly basin time series (highcharts)","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/plot_timeline.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot monthly basin time series (highcharts) — plot_timeline","text":"","code":"plot_timeline(   data,   yrange = NULL,   title = NULL,   subtitle = NULL,   unit = \"km³\",   ... )"},{"path":"https://github.mbacou.io/WADashboard/reference/plot_timeline.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot monthly basin time series (highcharts) — plot_timeline","text":"data biophysical time-series yrange y-axis min max title chart title subtitle chart subtitle sos start season threshold (default: 35 mm 8°C Tmin blooming)","code":""},{"path":[]},{"path":"https://github.mbacou.io/WADashboard/reference/plot_ts.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot variable time-series — plot_ts","title":"Plot variable time-series — plot_ts","text":"Plot variable time-series","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/plot_ts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot variable time-series — plot_ts","text":"","code":"plot_ts(dt, color = pal[1], unit = \"km³\")"},{"path":"https://github.mbacou.io/WADashboard/reference/plot_ts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot variable time-series — plot_ts","text":"unit","code":""},{"path":[]},{"path":"https://github.mbacou.io/WADashboard/reference/plot_ts.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot variable time-series — plot_ts","text":"","code":"plot_ts(DATA[iso3==\"mli\" & sheet==\"sheet1\" & variable==\"Rainfall\"])  {\"x\":{\"hc_opts\":{\"chart\":{\"reflow\":true,\"zoomType\":\"x\"},\"title\":[],\"yAxis\":{\"title\":{\"text\":null}},\"credits\":{\"enabled\":false},\"exporting\":{\"enabled\":false},\"boost\":{\"enabled\":false},\"plotOptions\":{\"series\":{\"label\":{\"enabled\":false},\"turboThreshold\":0},\"treemap\":{\"layoutAlgorithm\":\"squarified\"}},\"series\":[{\"group\":\"group\",\"data\":[{\"iso3\":\"mli\",\"sheet\":\"sheet1\",\"class\":\"INFLOW\",\"subclass\":\"PRECIPITATION\",\"variable\":\"Rainfall\",\"year\":2010,\"month\":null,\"date_start\":\"2010-01-01\",\"date_end\":\"2010-12-31\",\"value\":434.99,\"x\":1293753600000,\"y\":434.99},{\"iso3\":\"mli\",\"sheet\":\"sheet1\",\"class\":\"INFLOW\",\"subclass\":\"PRECIPITATION\",\"variable\":\"Rainfall\",\"year\":2011,\"month\":null,\"date_start\":\"2011-01-01\",\"date_end\":\"2011-12-31\",\"value\":349.29,\"x\":1325289600000,\"y\":349.29},{\"iso3\":\"mli\",\"sheet\":\"sheet1\",\"class\":\"INFLOW\",\"subclass\":\"PRECIPITATION\",\"variable\":\"Rainfall\",\"year\":2012,\"month\":null,\"date_start\":\"2012-01-01\",\"date_end\":\"2012-12-31\",\"value\":410.59,\"x\":1356912000000,\"y\":410.59},{\"iso3\":\"mli\",\"sheet\":\"sheet1\",\"class\":\"INFLOW\",\"subclass\":\"PRECIPITATION\",\"variable\":\"Rainfall\",\"year\":2013,\"month\":null,\"date_start\":\"2013-01-01\",\"date_end\":\"2013-12-31\",\"value\":389.16,\"x\":1388448000000,\"y\":389.16},{\"iso3\":\"mli\",\"sheet\":\"sheet1\",\"class\":\"INFLOW\",\"subclass\":\"PRECIPITATION\",\"variable\":\"Rainfall\",\"year\":2014,\"month\":null,\"date_start\":\"2014-01-01\",\"date_end\":\"2014-12-31\",\"value\":355.2,\"x\":1419984000000,\"y\":355.2},{\"iso3\":\"mli\",\"sheet\":\"sheet1\",\"class\":\"INFLOW\",\"subclass\":\"PRECIPITATION\",\"variable\":\"Rainfall\",\"year\":2015,\"month\":null,\"date_start\":\"2015-01-01\",\"date_end\":\"2015-12-31\",\"value\":376.52,\"x\":1451520000000,\"y\":376.52},{\"iso3\":\"mli\",\"sheet\":\"sheet1\",\"class\":\"INFLOW\",\"subclass\":\"PRECIPITATION\",\"variable\":\"Rainfall\",\"year\":2016,\"month\":null,\"date_start\":\"2016-01-01\",\"date_end\":\"2016-12-31\",\"value\":366.98,\"x\":1483142400000,\"y\":366.98},{\"iso3\":\"mli\",\"sheet\":\"sheet1\",\"class\":\"INFLOW\",\"subclass\":\"PRECIPITATION\",\"variable\":\"Rainfall\",\"year\":2017,\"month\":null,\"date_start\":\"2017-01-01\",\"date_end\":\"2017-12-31\",\"value\":383.25,\"x\":1514678400000,\"y\":383.25}],\"type\":\"area\",\"name\":\"Rainfall\",\"color\":\"#28537D\",\"fillColor\":\"#28537D33\",\"marker\":{\"enabled\":true}}],\"xAxis\":{\"type\":\"datetime\",\"dateTimeLabelFormats\":{\"month\":\"%e %b\"}},\"tooltip\":{\"valueSuffix\":\" km³\",\"pointFormat\":\"{series.name}: <strong>{point.y:,.2f}<\\/strong><br/>\"},\"legend\":{\"enabled\":true,\"align\":\"top\"},\"subtitle\":{\"text\":null}},\"theme\":{\"chart\":{\"style\":{\"fontFamily\":null},\"backgroundColor\":\"transparent\"},\"colors\":[\"#28537D\",\"#46BBD4\",\"#5088C6\",\"#0297A6\",\"#22AD7A\",\"#DD9103\",\"#8B2635\",\"#51291E\",\"#FFE156\",\"#333333\",\"#E8E7E7\"],\"title\":{\"style\":{\"color\":\"#333333\",\"fontSize\":\"16px\"},\"align\":\"left\"},\"subtitle\":{\"style\":{\"color\":\"#333333\",\"fontSize\":\"13px\"},\"align\":\"left\"},\"legend\":{\"enabled\":true,\"itemStyle\":{\"color\":\"#333333\"},\"verticalAlign\":\"top\",\"align\":\"left\",\"itemHoverStyle\":{\"color\":\"#333333\"}},\"xAxis\":{\"title\":{\"enabled\":false},\"dateTimeLabelFormats\":{\"day\":\"%e %b\",\"week\":\"%e %b %y\",\"month\":\"%b-%y\",\"year\":\"%Y\"}},\"yAxis\":{\"title\":{\"enabled\":false}},\"tooltip\":{\"enabled\":true,\"shared\":true,\"split\":false,\"pointFormat\":\"{series.name}: <strong>{point.y:,.1f}<\\/strong><br/>\",\"xDateFormat\":\"%Y-%m-%d\",\"dateTimeLabelFormats\":\"%Y-%m-%d\",\"valueDecimals\":2},\"plotOptions\":{\"series\":{\"opacity\":0.8,\"connectNulls\":true,\"marker\":{\"enabled\":null,\"radius\":3,\"enabledThreshold\":8},\"dataLabels\":{\"enabled\":null,\"style\":{\"fontSize\":\"11px\"}}},\"area\":{\"lineWidth\":0,\"fillOpacity\":0.3,\"marker\":{\"enabled\":false,\"radius\":0}},\"arearange\":{\"lineWidth\":0,\"fillOpacity\":0.2,\"marker\":{\"enabled\":false,\"radius\":3}},\"pie\":{\"lineWidth\":0,\"startAngle\":-90,\"endAngle\":270,\"size\":\"84%\",\"innerSize\":\"68%\",\"center\":[\"50%\",\"40%\"],\"dataLabels\":{\"enabled\":false}},\"bullet\":{\"pointPadding\":0.25,\"borderWidth\":0,\"targetOptions\":{\"width\":\"200%\",\"color\":\"#5088C6\"}},\"boxplot\":{\"fillColor\":\"#3333334C\",\"lineWidth\":0.5,\"whiskerWidth\":5,\"stemWidth\":1,\"stemDashStyle\":\"solid\",\"whiskerColor\":\"#5088C6\",\"stemColor\":\"#5088C6\",\"medianColor\":\"#5088C6\"},\"heatmap\":{\"marker\":{\"enabled\":true,\"lineWidth\":6,\"lineColor\":\"#E8E7E7\"},\"dataLabels\":{\"enabled\":true,\"pointFormat\":\"{point.value:,.0f}\"}}},\"exporting\":{\"enabled\":true,\"csv\":{\"dateFormat\":\"%Y-%m-%d\"},\"buttons\":{\"contextButton\":{\"symbolSize\":12,\"symbolFill\":\"#E8E7E7\",\"symbolStroke\":\"#333333\",\"symbolStrokeWidth\":1.3,\"menuItems\":[\"printChart\",\"downloadPNG\",\"downloadSVG\",\"downloadCSV\"]}}},\"credits\":{\"enabled\":false,\"position\":{\"align\":\"left\"},\"href\":\"https://wateraccounting.org/\",\"style\":{\"fontSize\":\"11px\"}}},\"conf_opts\":{\"global\":{\"Date\":null,\"VMLRadialGradientURL\":\"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png\",\"canvasToolsURL\":\"http =//code.highcharts.com/list(version)/modules/canvas-tools.js\",\"getTimezoneOffset\":null,\"timezoneOffset\":0,\"useUTC\":true},\"lang\":{\"contextButtonTitle\":\"Chart context menu\",\"decimalPoint\":\".\",\"downloadCSV\":\"Download CSV\",\"downloadJPEG\":\"Download JPEG image\",\"downloadPDF\":\"Download PDF document\",\"downloadPNG\":\"Download PNG image\",\"downloadSVG\":\"Download SVG vector image\",\"downloadXLS\":\"Download XLS\",\"drillUpText\":\"◁ Back to {series.name}\",\"exitFullscreen\":\"Exit from full screen\",\"exportData\":{\"annotationHeader\":\"Annotations\",\"categoryDatetimeHeader\":\"DateTime\",\"categoryHeader\":\"Category\"},\"hideData\":\"Hide data table\",\"invalidDate\":null,\"loading\":\"Loading...\",\"months\":[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],\"noData\":\"No data to display\",\"numericSymbolMagnitude\":1000,\"numericSymbols\":[\"k\",\"M\",\"G\",\"T\",\"P\",\"E\"],\"printChart\":\"Print chart\",\"resetZoom\":\"Reset zoom\",\"resetZoomTitle\":\"Reset zoom level 1:1\",\"shortMonths\":[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"],\"shortWeekdays\":[\"Sat\",\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\"],\"thousandsSep\":\" \",\"viewData\":\"View data table\",\"viewFullscreen\":\"View in full screen\",\"weekdays\":[\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"]}},\"type\":\"chart\",\"fonts\":[],\"debug\":false},\"evals\":[],\"jsHooks\":[]}"},{"path":"https://github.mbacou.io/WADashboard/reference/scoreBox.html","id":null,"dir":"Reference","previous_headings":"","what":"Scorecard Box — scoreBox","title":"Scorecard Box — scoreBox","text":"Modified version bs4Dash::valueBox()","code":""},{"path":"https://github.mbacou.io/WADashboard/reference/scoreBox.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scorecard Box — scoreBox","text":"","code":"scoreBox(   value,   subtitle,   icon = NULL,   color = NULL,   width = 3,   href = NULL,   footer = NULL,   gradient = FALSE,   elevation = NULL )"},{"path":"https://github.mbacou.io/WADashboard/reference/scoreBox.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scorecard Box — scoreBox","text":"value value display box. Usually number short text. subtitle Subtitle text. icon icon tag, created icon. color color item. determines item's background   color.  Valid colors defined follows: primary: #007bff . secondary: #6c757d . info: #17a2b8 . success: #28a745 . warning: #ffc107 . danger: #dc3545 . gray-dark: #343a40 . gray: #adb5bd . white: #fff . indigo: #6610f2 . lightblue: #3c8dbc . navy: #001f3f . purple: #605ca8 . fuchsia: #f012be . pink: #e83e8c . maroon: #d81b60 . orange: #ff851b . lime: #01ff70 . teal: #39cccc . olive: #3d9970 . width width box, using Bootstrap grid system. used row-based layouts. overall width region 12, default width 4 occupies 1/3 width. column-based layouts, use NULL width; width set column contains box. href optional URL link footer. `footer` parameter set, `footer` take precedence. footer Optional html content footer box. gradient Whether use gradient style background color. Default FALSE. elevation Value box elevation.","code":""},{"path":[]},{"path":[]},{"path":"https://github.mbacou.io/WADashboard/news/index.html","id":"v011-development-version","dir":"Changelog","previous_headings":"","what":"v0.1.1","title":"WADashboard (development version)","text":"Added sustainability variability indicators Added 2 vignettes","code":""},{"path":"https://github.mbacou.io/WADashboard/news/index.html","id":"v002-development-version","dir":"Changelog","previous_headings":"","what":"v0.0.2","title":"WADashboard (development version)","text":"First concept layout","code":""},{"path":"https://github.mbacou.io/WADashboard/news/index.html","id":"v001-development-version","dir":"Changelog","previous_headings":"","what":"v0.0.1","title":"WADashboard (development version)","text":"Initial commit","code":""}]
